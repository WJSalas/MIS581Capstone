"0","# 1,000 ft = 0.3048 km"
"0","# 1 mile = 1.609344 km"
"0",""
"0","## Stacked for loop"
"0","# Count the number of rows in each of the dataframes. These will be used to set our for loops."
"0","n1 <- nrow(Well_Data)"
"0","n2 <- nrow(Assessor_Data)"
"0",""
"0","# Create a new dataframe called df where we will keep track of our outputs from the for loops."
"0","df <- data.frame(Well_API=character(),"
"0","                 Well_ID=character(),"
"0","                 Well_Status=character(),"
"0","                 Oil_Sales=integer(),"
"0","                 Gas_Sales=integer(),"
"0","                 Stripper_flg=character(),"
"0","                 Well_Tot_Mill=numeric(),"
"0","                 Well_Asd_Val=integer(),"
"0","                 H1000=integer(), "
"0","                 H5280=integer(), "
"0","                 Well_PTax=numeric(), "
"0","                 Sum_Home_Asd_Val=integer(),"
"0","                 Sum_Home_PTax=numeric(),"
"0","                 stringsAsFactors = FALSE)"
"0",""
"0","for (i in 1:n1){"
"0","  # Initialize the counting veriables for each loop through the Well_Data dataframe."
"0","  tax_sum <- 0"
"0","  h_asd_sum <- 0"
"0","  h_count <- 0"
"0","  H1K <- 0"
"0","  "
"0","  for (j in 1:n2){"
"0","    # Assign each Lat and Long to the correct input"
"0","    long1 <- Well_Data$long1[i]"
"0","    lat1 <- Well_Data$lat1[i]"
"0","    long2 <- Assessor_Data$long2[j]"
"0","    lat2 <- Assessor_Data$lat2[j]"
"0","    "
"0","    # Calculate the distances between the Well and home"
"0","    dist_km <- rdist.earth(matrix(c(long1,lat1), ncol=2), matrix(c(long2,lat2), ncol=2), miles = FALSE, R = 6371)"
"0","    "
"0","     # if-else statement that will be used to tally the number of homes within the two different ranges that we are interested in and exclude anything over 1 mile away from a well."
"0","     if (dist_km > 1.609344){"
"0","       next"
"0","     }else if (dist_km <= 1.609344 & dist_km > 0.3048){"
"0","       H1K_new <- 0"
"0","       h_count_new <- 1"
"0","       h_asd <- Assessor_Data$TOT_ACTVAL[j]"
"0","       h_tax <- Assessor_Data$Calc_Taxes[j]"
"0","     }else if (dist_km <= 0.3048){"
"0","       H1K_new <- 1"
"0","       h_count_new <- 1"
"0","       h_asd <- Assessor_Data$TOT_ACTVAL[j]"
"0","       h_tax <- Assessor_Data$Calc_Taxes[j]"
"0","     }"
"0","     "
"0","     # Count the number of homes within 1000 ft"
"0","     H1K <- H1K + H1K_new"
"0","     "
"0","     # Count the number of homes within one mile of the well"
"0","     h_count <- h_count + h_count_new"
"0","     "
"0","     # Sum up the total home assessed values"
"0","     h_asd_sum <- h_asd_sum + h_asd"
"0","     "
"0","     # Summaries the total Property Tax amount for all of the homes within one mile of the well"
"0","     tax_sum <- tax_sum + h_tax"
"0","  }"
"0","   # Create a dataframe from the ouput of the if-else statement and append it to the df"
"0","   df_new <- c(Well_Data$API_Label[i], Well_Data$Well_ID[i], Well_Data$Well_Stat[i], Well_Data$Oil_Sales[i], Well_Data$Gas_Sales[i], Well_Data$stripper_flg[i], Well_Data$tot_mill[i], Well_Data$asd_val[i], H1K, h_count, Well_Data$Tax_Est[i], h_asd_sum, tax_sum)"
"0","   df <- rbind(df, df_new)"
"0","}"
"0",""
"0","# Rename the columns in the df Output"
"0","colnames(df) <- c(""Well_API"", ""Well_ID"", ""Well_Status"", ""Oil_Sales"", ""Gas_Sales"", ""Stripper_flg"", ""Well_Tot_Mill"", ""Well_Asd_Val"", ""H1000"", ""H5280"", ""Well_PTax"", ""Sum_Home_Asd_Val"", ""Sum_Home_PTax"") "
